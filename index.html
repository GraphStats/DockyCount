<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FastCount</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@900&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/odometer.js/0.4.8/themes/odometer-theme-default.min.css" />
  <link rel="icon" type="image/png" href="https://cdn.glitch.global/3646dfb4-5cb1-4c3c-9337-1d56b96025d2/Design_sans_titre-removebg-preview%20(1).png?v=1746820022653">
  <meta name="trustpilot-one-time-domain-verification-id" content="3d078e23-117c-46ae-991c-63c340043c1f"/>
  <meta name="description" content="FastCount Is THE BEST Counter">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7562628849511682" crossorigin="anonymous"></script>
  <meta name="google-adsense-account" content="ca-pub-7562628849511682">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/odometer.js/0.4.8/odometer.min.js"></script>
  <style>
    /* === Mini refonte graphique, d√©tails modernis√©s === */
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      height: 100vh;
      font-family: 'Roboto', Arial, sans-serif;
      background: linear-gradient(120deg, #111d2b 0%, #24243e 100%);
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow-x: hidden;
      transition: background 0.2s, color 0.2s;
    }
    body.light-theme {
      background: #f6f8fa;
      color: #232323;
    }

    #main-content { width: 100%; max-width: 600px; margin: 0 auto; }

    #logo {
      position: absolute;
      top: 20px;
      left: 20px;
      width: 160px;
      cursor: pointer;
      filter: drop-shadow(0 2px 12px rgba(0,255,240,0.12));
      transition: transform 0.2s;
    }
    #logo:hover { transform: scale(1.05) rotate(2deg); }

    .glass-card {
      background: rgba(255,255,255,0.07);
      border: 1px solid rgba(255,255,255,0.13);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 24px 28px;
      box-shadow: 0 4px 24px 0 rgba(31,38,135,0.10);
      margin: 18px 0;
      transition: background 0.2s, border 0.2s;
    }
    body.light-theme .glass-card {
      background: rgba(255,255,255,0.8);
      border: 1px solid rgba(0,0,0,0.08);
    }

    input[type="text"] {
      width: 260px;
      padding: 13px;
      font-size: 1.1em;
      border-radius: 8px;
      border: none;
      outline: none;
      margin-bottom: 18px;
      background: rgba(255,255,255,0.08);
      color: #00fff0;
      box-shadow: 0 2px 8px 0 rgba(0,255,240,0.03);
      transition: background 0.2s, color 0.2s;
    }
    body.light-theme input[type="text"] {
      background: rgba(0,0,0,0.04);
      color: #008080;
    }

    button {
      padding: 13px 24px;
      border: none;
      border-radius: 8px;
      background: linear-gradient(135deg, #00fff0, #008080);
      color: #222;
      font-weight: bold;
      font-size: 1.1em;
      cursor: pointer;
      font-family: 'Roboto', Arial, sans-serif;
      box-shadow: 0 1px 6px 0 rgba(0,255,240,0.08);
      transition: background 0.2s, transform 0.2s;
      margin-top: 8px;
    }
    button:hover {
      background: linear-gradient(135deg, #00c0ff, #006666);
      transform: scale(1.04);
    }

    #result-list {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 24px;
      gap: 14px;
    }
    .channel-result {
      background: rgba(255,255,255,0.10);
      backdrop-filter: blur(6px);
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 10px;
      padding: 14px 18px;
      color: #00fff0;
      cursor: pointer;
      font-size: 1.06em;
      transition: background 0.2s, transform 0.2s;
    }
    .channel-result:hover { background: rgba(0,255,240,0.14); transform: scale(1.06);}
    body.light-theme .channel-result { background: rgba(0,0,0,0.05); color: #008080; }

    #counter-container {
      display: none;
      margin-top: 20px;
      flex-direction: column;
      align-items: center;
      gap: 16px;
    }
    #channel-avatar {
      width: 110px;
      height: 110px;
      border-radius: 50%;
      border: 3px solid #00fff0;
      object-fit: cover;
      margin-bottom: 6px;
      transition: border 0.2s;
    }
    body.light-theme #channel-avatar { border-color: #008080; }

    #channel-name {
      font-size: 1.4em;
      font-weight: bold;
      margin-bottom: 2px;
      text-align: center;
    }
    #subscriber-count {
      font-family: 'Roboto', Arial, sans-serif;
      font-size: 3.7em;
      color: #fff;
      margin-bottom: 6px;
      transition: color 0.2s;
    }
    body.light-theme #subscriber-count { color: #232323; }
    #subscriber-change {
      font-size: 1em;
      margin-bottom: 4px;
      font-weight: 500;
    }

    #footer {
      position: absolute;
      bottom: 15px;
      font-size: 0.9em;
      color: #aaa;
      text-align: center;
    }

    #only-count-button { display: none; }

    .loader {
      display: none;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #00fff0;
      border-radius: 50%;
      width: 34px;
      height: 34px;
      animation: spin 1s linear infinite;
      margin: 14px auto;
    }
    @keyframes spin {
      0% { transform: rotate(0deg);}
      100% {transform: rotate(360deg);}
    }

    #share-button {
      position: absolute; top: 18px; right: 18px;
      background: linear-gradient(135deg, #00c0ff, #006666);
      padding: 8px 13px;
      border-radius: 8px;
      display: none;
      font-size: 1em;
      z-index: 10;
    }
    #share-button:hover { background: linear-gradient(135deg, #00fff0, #008080); }

    .share-options {
      display: none;
      position: absolute;
      top: 52px; right: 18px;
      background: rgba(255,255,255,0.10);
      backdrop-filter: blur(6px);
      border-radius: 8px;
      padding: 7px 0;
      z-index: 100;
      min-width: 130px;
      animation: slideIn 0.2s ease-out;
    }
    .share-option {
      padding: 7px 12px;
      margin: 2px 0;
      background: rgba(255,255,255,0.10);
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.98em;
      transition: background 0.15s;
    }
    .share-option:hover { background: rgba(0,255,240,0.12);}
    @keyframes slideIn {
      0% { opacity: 0; transform: translateX(60%);}
      100% {opacity: 1; transform: translateX(0);}
    }
    body.light-theme .share-options { background: rgba(0,0,0,0.07);}
    body.light-theme .share-option { background: rgba(0,0,0,0.09);}
    body.light-theme .share-option:hover { background: rgba(0,0,0,0.17);}

    #main-content { opacity: 0; transform: translateY(16px); transition: opacity 0.7s, transform 0.7s;}
    #main-content.visible { opacity: 1; transform: translateY(0); }

    #chart-container {
      width: 98%; max-width: 650px;
      margin: 16px auto;
      display: none;
    }
    #subscriberChart { width: 100% !important; height: 350px !important;}
    #toggle-chart-button { margin-top: 12px;}

    .toast {
      position: fixed;
      bottom: 18px; left: 50%; transform: translateX(-50%);
      background: rgba(0,255,240,0.92);
      color: #000;
      padding: 10px 18px;
      border-radius: 7px;
      font-weight: bold;
      opacity: 0;
      transition: opacity 0.25s;
      z-index: 1400;
    }
    .toast.show { opacity: 1; }
    body.light-theme .toast { background: rgba(0,200,200,0.92); }

    @media (max-width: 768px) {
      #logo { width: 110px; }
      input[type="text"] { width: 170px;}
      #subscriber-count { font-size: 2.1em;}
      #channel-avatar { width: 68px; height: 68px;}
      #share-button { top: 12px; right: 12px; font-size: 0.98em;}
    }
    @media (max-width: 480px) {
      #logo { width: 70px; top: 9px; left: 9px;}
      input[type="text"] { width: 105px; padding: 8px;}
      button { padding: 10px 16px;}
      #subscriber-count { font-size: 1.4em;}
    }
  </style>
</head>
<body>
  <img id="logo" src="https://cdn.glitch.global/3646dfb4-5cb1-4c3c-9337-1d56b96025d2/Design_sans_titre-removebg-preview.png?v=1746819783500" onclick="window.location.href='/'" alt="FastCount Logo">
  <div id="main-content">
    <div id="search-bar-container">
      <div id="search-bar">
        <input type="text" id="channel-input" placeholder="YouTube channel name" onkeypress="handleKeyPress(event)" />
        <button id="search-btn" type="button" onclick="fetchChannelData()">üîç</button>
      </div>
      <div class="loader" id="loader"></div>
    </div>
    <button id="share-button" onclick="toggleShareOptions()">Share</button>
    <div class="share-options" id="share-options">
      <div class="share-option" onclick="shareOnTwitter()">Twitter (X)</div>
      <div class="share-option" onclick="shareOnFacebook()">Facebook</div>
      <div class="share-option" onclick="copyLink()">Copy Link</div>
    </div>
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7562628849511682" data-ad-slot="2412018290" data-ad-format="auto" data-full-width-responsive="true"></ins>
    <div id="result-list"></div>
    <div class="glass-card" id="counter-container">
      <img id="channel-avatar" src="" alt="Channel Avatar">
      <div id="channel-name"></div>
      <div id="subscriber-count" class="odometer">0</div>
      <div id="subscriber-change"></div>
      <button id="toggle-chart-button" onclick="toggleChart()">Show History</button>
    </div>
    <div class="glass-card" id="chart-container">
      <canvas id="subscriberChart"></canvas>
    </div>
    <div style="margin: 12px 0;">
      <button id="only-count-button" onclick="activateOnlyCount()">Only Count</button>
      <button id="theme-toggle" onclick="toggleTheme()">üåó Theme</button>
    </div>
    <div class="toast" id="toast"></div>
  </div>
  <div id="footer">FastCount &copy; 2025 ‚Ä¢ Enjoy real time YouTube stats</div>
  <script>
    // === Constants & State ===
    const API_BASE_URL = 'https://backend.mixerno.space/api/youtube/estv3/';
    const SEARCH_API_URL = 'https://mixerno.space/api/youtube-channel-counter/search/';
    const MAX_DATA_POINTS = 3600;
    const UPDATE_INTERVAL = 2000;
    const state = {
      channelId: null,
      intervalId: null,
      odometer: null,
      subscriberChart: null,
      historicalData: [],
      lastSubscriberCount: 0,
      isLightTheme: localStorage.getItem('theme') === 'light',
    };

    // === DOM Elements ===
    const elements = {
      channelInput: document.getElementById("channel-input"),
      loader: document.getElementById("loader"),
      resultList: document.getElementById("result-list"),
      counterContainer: document.getElementById("counter-container"),
      channelAvatar: document.getElementById("channel-avatar"),
      channelName: document.getElementById("channel-name"),
      subscriberCount: document.getElementById("subscriber-count"),
      subscriberChange: document.getElementById("subscriber-change"),
      toggleChartButton: document.getElementById("toggle-chart-button"),
      chartContainer: document.getElementById("chart-container"),
      shareButton: document.getElementById("share-button"),
      shareOptions: document.getElementById("share-options"),
      onlyCountButton: document.getElementById("only-count-button"),
      toast: document.getElementById("toast"),
      themeToggle: document.getElementById("theme-toggle"),
      body: document.body,
      mainContent: document.getElementById("main-content"),
      searchBarContainer: document.getElementById("search-bar-container"),
    };

    // === App Init ===
    function init() {
      setupEventListeners();
      checkUrlFragment();
      showToast('Welcome to FastCount!', 2000);
      if (state.isLightTheme) applyLightTheme();
      setTimeout(() => elements.mainContent.classList.add('visible'), 80);
    }

    function setupEventListeners() {
      document.addEventListener('keydown', handleKeyboardShortcuts);
      document.addEventListener('click', (event) => {
        if (!elements.shareButton.contains(event.target) && !elements.shareOptions.contains(event.target)) {
          elements.shareOptions.style.display = "none";
        }
      });
      window.addEventListener('popstate', handleNavigation);
    }

    function handleNavigation() {
      const urlFragment = window.location.hash.slice(1);
      if (urlFragment && urlFragment !== state.channelId) {
        resetCounter();
        state.channelId = urlFragment;
        startCounter();
      } else if (!urlFragment) {
        resetCounter();
      }
    }

    function checkUrlFragment() {
      const urlFragment = window.location.hash.slice(1);
      if (urlFragment) {
        state.channelId = urlFragment;
        startCounter();
      }
    }

    function startCounter() {
      elements.counterContainer.style.display = "flex";
      elements.shareButton.style.display = "block";
      elements.onlyCountButton.style.display = "inline-block";
      if (!state.odometer) {
        state.odometer = new Odometer({el: elements.subscriberCount, value: 0, format: '(,ddd)'});
      }
      fetchStatsData();
      state.intervalId = setInterval(fetchStatsData, UPDATE_INTERVAL);
    }

    function resetCounter() {
      clearInterval(state.intervalId);
      elements.counterContainer.style.display = "none";
      elements.shareButton.style.display = "none";
      elements.onlyCountButton.style.display = "none";
      elements.chartContainer.style.display = "none";
      elements.toggleChartButton.textContent = "Show History";
      state.historicalData = [];
      if (state.subscriberChart) {
        state.subscriberChart.destroy();
        state.subscriberChart = null;
      }
      document.title = "FastCount";
    }

    function showToast(message, duration = 2400) {
      elements.toast.textContent = message;
      elements.toast.classList.add('show');
      setTimeout(() => { elements.toast.classList.remove('show'); }, duration);
    }

    function handleKeyPress(event) {
      if (event.key === "Enter") fetchChannelData();
    }
    function handleKeyboardShortcuts(event) {
      if (event.ctrlKey && event.key === 'Enter') fetchChannelData();
      if (event.key === 'Escape') elements.channelInput.value = '';
    }

    async function fetchChannelData() {
      const channelName = elements.channelInput.value.trim();
      if (!channelName) return showToast("Please enter a channel name.");
      elements.loader.style.display = "block";
      elements.resultList.innerHTML = "";
      try {
        const response = await fetch(`${SEARCH_API_URL}${encodeURIComponent(channelName)}`);
        if (!response.ok) throw new Error('Network response was not ok');
        const data = await response.json();
        elements.loader.style.display = "none";
        if (!data.list?.length) return showToast("Channel not found.");
        displayChannelResults(data.list);
      } catch (error) {
        elements.loader.style.display = "none";
        showToast("Error fetching channel data.");
      }
    }

    function displayChannelResults(channels) {
      elements.resultList.innerHTML = "";
      channels.forEach((ch) => {
        const el = document.createElement("div");
        el.textContent = ch[0];
        el.className = "channel-result";
        el.onclick = () => {
          window.location.hash = "#" + ch[2];
          state.channelId = ch[2];
          resetCounter();
          startCounter();
          elements.resultList.innerHTML = "";
        };
        elements.resultList.appendChild(el);
      });
    }

    function initializeChart() {
      if (state.subscriberChart) state.subscriberChart.destroy();
      const ctx = document.getElementById('subscriberChart').getContext('2d');
      state.subscriberChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: [],
          datasets: [{
            label: 'Subscribers',
            data: [],
            borderColor: state.isLightTheme ? '#008080' : '#00fff0',
            backgroundColor: state.isLightTheme ? 'rgba(0,128,128,0.1)' : 'rgba(0,255,240,0.1)',
            borderWidth: 3,
            tension: 0.1,
            pointRadius: 0,
            fill: true
          }]
        },
        options: {
          animation: false,
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false }},
          scales: {
            x: { display: false, grid: { display: false }},
            y: {
              display: false,
              grid: { color: state.isLightTheme ? 'rgba(0,0,0,0.09)' : 'rgba(255,255,255,0.09)', drawBorder: false },
              ticks: {
                color: state.isLightTheme ? 'rgba(0,0,0,0.6)' : 'rgba(255,255,255,0.6)',
                callback: (v) => v >= 1e6 ? (v/1e6).toFixed(1)+'M' : (v>=1e3 ? (v/1e3).toFixed(1)+'K' : v)
              }
            }
          },
          interaction: { mode: 'nearest', axis: 'x', intersect: false }
        }
      });
    }

    function updateChart(count) {
      const now = new Date();
      const timeString = now.toLocaleTimeString();
      state.historicalData.push({ time: timeString, count: count });
      if (state.historicalData.length > MAX_DATA_POINTS) state.historicalData.shift();
      if (!state.subscriberChart) initializeChart();
      state.subscriberChart.data.labels = state.historicalData.map(d => d.time);
      state.subscriberChart.data.datasets[0].data = state.historicalData.map(d => d.count);
      state.subscriberChart.update();
    }

    async function fetchStatsData() {
      try {
        const response = await fetch(`${API_BASE_URL}${state.channelId}`);
        if (response.ok) {
          const data = await response.json();
          if (data?.items?.length > 0) {
            const channel = data.items[0];
            updateChannelInfo(channel);
            if (channel.statistics && typeof channel.statistics.subscriberCount === "number") {
              const subscriberCount = channel.statistics.subscriberCount;
              updateSubscriberCount(subscriberCount);
              if (state.lastSubscriberCount > 0) {
                const change = subscriberCount - state.lastSubscriberCount;
                updateSubscriberChange(change);
              }
              state.lastSubscriberCount = subscriberCount;
              updateChart(subscriberCount);
            }
          }
        }
      } catch (_) {}
    }

    function updateChannelInfo(channel) {
      elements.channelAvatar.src = channel.snippet.thumbnails.default.url;
      elements.channelName.textContent = channel.snippet.title;
      document.title = `${channel.snippet.title} - FastCount`;
    }

    function updateSubscriberCount(count) {
      if (!state.odometer) {
        state.odometer = new Odometer({el: elements.subscriberCount, value: count, format: '(,ddd)'});
      } else {
        state.odometer.update(count);
      }
    }

    function updateSubscriberChange(change) {
      if (change === 0) {
        elements.subscriberChange.textContent = "‚Üí No change";
        elements.subscriberChange.style.color = state.isLightTheme ? "#666" : "#aaa";
      } else if (change > 0) {
        elements.subscriberChange.textContent = `‚Üë +${change.toLocaleString()}`;
        elements.subscriberChange.style.color = "#00ff00";
      } else {
        elements.subscriberChange.textContent = `‚Üì ${change.toLocaleString()}`;
        elements.subscriberChange.style.color = "#ff0000";
      }
    }

    function toggleChart() {
      if (elements.chartContainer.style.display === 'none' || elements.chartContainer.style.display === '') {
        elements.chartContainer.style.display = 'block';
        elements.toggleChartButton.textContent = 'Hide History';
        if (!state.subscriberChart && state.historicalData.length > 0) {
          initializeChart();
          updateChart(state.historicalData[state.historicalData.length - 1].count);
        }
      } else {
        elements.chartContainer.style.display = 'none';
        elements.toggleChartButton.textContent = 'Show History';
      }
    }

    function activateOnlyCount() {
      elements.searchBarContainer.style.display = "none";
      elements.channelAvatar.style.display = "none";
      elements.channelName.style.display = "none";
      elements.shareButton.style.display = "none";
      elements.subscriberChange.style.display = "none";
      elements.subscriberCount.style.fontSize = "7em";
      elements.counterContainer.style.alignItems = "flex-start";
      elements.counterContainer.style.marginTop = "80px";
      elements.counterContainer.style.justifyContent = "center";
      elements.counterContainer.style.height = "100vh";
      elements.onlyCountButton.style.display = "none";
      showToast("Only count mode: refresh to exit.", 1800);
    }

    function toggleShareOptions() {
      elements.shareOptions.style.display =
        elements.shareOptions.style.display === "block" ? "none" : "block";
    }

    function shareOnTwitter() {
      const channelName = elements.channelName.textContent || "YouTube channel";
      const count = elements.subscriberCount.textContent || "0";
      const text = `Check out ${channelName}'s subscriber count: ${count} on FastCount!`;
      const url = window.location.href;
      window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`, '_blank');
      elements.shareOptions.style.display = "none";
    }
    function shareOnFacebook() {
      const url = encodeURIComponent(window.location.href);
      window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
      elements.shareOptions.style.display = "none";
    }
    function copyLink() {
      const url = window.location.href;
      navigator.clipboard.writeText(url).then(() => {
        showToast("Link copied to clipboard!");
        elements.shareOptions.style.display = "none";
      }).catch(() => showToast("Failed to copy link."));
    }

    function applyLightTheme() {
      elements.body.classList.add('light-theme');
      if (state.subscriberChart) {
        state.subscriberChart.data.datasets[0].borderColor = '#008080';
        state.subscriberChart.data.datasets[0].backgroundColor = 'rgba(0,128,128,0.1)';
        state.subscriberChart.options.scales.y.ticks.color = 'rgba(0,0,0,0.6)';
        state.subscriberChart.options.scales.y.grid.color = 'rgba(0,0,0,0.09)';
        state.subscriberChart.update();
      }
    }
    function applyDarkTheme() {
      elements.body.classList.remove('light-theme');
      if (state.subscriberChart) {
        state.subscriberChart.data.datasets[0].borderColor = '#00fff0';
        state.subscriberChart.data.datasets[0].backgroundColor = 'rgba(0,255,240,0.1)';
        state.subscriberChart.options.scales.y.ticks.color = 'rgba(255,255,255,0.6)';
        state.subscriberChart.options.scales.y.grid.color = 'rgba(255,255,255,0.09)';
        state.subscriberChart.update();
      }
    }
    function toggleTheme() {
      state.isLightTheme = !state.isLightTheme;
      localStorage.setItem('theme', state.isLightTheme ? 'light' : 'dark');
      if (state.isLightTheme) applyLightTheme();
      else applyDarkTheme();
    }

    document.addEventListener('DOMContentLoaded', () => {
      init();
      (adsbygoogle = window.adsbygoogle || []).push({});
    });
  </script>
</body>
</html>